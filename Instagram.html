<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Status Clone</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

        :root {
            --bg-color: #000;
            --text-color: #fff;
            --progress-bar-bg: rgba(255, 255, 255, 0.4);
            --progress-bar-fill: #fff;
            --input-bg: rgba(255, 255, 255, 0.2);
            --instagram-pink: #ED4956;
        }

        html, body {
            height: 100%;
            margin: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            flex-direction: column;
        }
        
        /* New Container for Cube Flip */
        .story-cube-container {
            width: 100%;
            height: 100%;
            perspective: 1200px;
            position: relative;
        }
        
        .status-container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.4s ease-in-out;
        }
        
        /* Adjustments for Cube Faces */
        .status-card {
            width: 100%;
            height: 100%;
            position: absolute;
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            border-radius: 10px;
            backface-visibility: hidden;
        }

        /* Initial positions for cube faces */
        .status-card[data-user="emily"] {
            transform: rotateY(0deg) translateZ(187.5px);
        }
        .status-card[data-user="michael"] {
            transform: rotateY(90deg) translateZ(187.5px);
        }
        .status-card[data-user="sarah"] {
            transform: rotateY(180deg) translateZ(187.5px);
        }

        .status-card.active {
            display: flex; /* Keep the card visible */
        }

        .progress-bar-container {
            display: flex;
            padding: 5px;
            gap: 4px;
            width: 95%;
            margin: 10px auto 0;
        }

        .progress-bar {
            height: 3px;
            background-color: var(--progress-bar-bg);
            border-radius: 2px;
            overflow: hidden;
            flex: 1;
        }

        .progress-bar .progress {
            height: 100%;
            width: 0;
            background-color: var(--progress-bar-fill);
        }

        .user-info {
            display: flex;
            align-items: center;
            padding: 10px;
            gap: 10px;
            z-index: 20;
            pointer-events: none;
        }

        .user-info .profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid var(--text-color);
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-details .username {
            font-weight: 600;
        }

        .user-details .timestamp {
            font-size: 0.8em;
            color: #ccc;
        }

        .status-content {
            flex-grow: 1;
            position: relative;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            pointer-events: none;
        }

        .status-content img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            max-height: calc(92% - 87px);
            bottom: 55px;
            object-fit: cover;
            display: block;
        }
        
        /* Keep nav zones, but for touch events */
        .navigation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: calc(100% - 136px);
            display: flex;
            z-index: 10;
        }

        .nav-zone {
            flex-grow: 1;
            height: 100%;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        .nav-zone.left {
            width: 30%;
        }

        .nav-zone.right {
            width: 70%;
        }

        .bottom-bar {
            position: absolute;
            bottom: 66px;
            left: 0;
            width: 100%;
            height: 70px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            box-sizing: border-box;
            z-index: 20;
            background-color: var(--bg-color);
            pointer-events: auto;
        }

        .reply-input-container {
            flex-grow: 1;
            margin-right: 15px;
        }

        .reply-input {
            width: 100%;
            padding: 10px 15px;
            border-radius: 25px;
            border: none;
            background-color: var(--input-bg);
            color: var(--text-color);
            font-size: 1em;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        .reply-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .action-icon-btn {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        .action-icon-btn svg {
            width: 24px;
            height: 24px;
            fill: none;
            stroke: var(--text-color);
            stroke-width: 2;
        }

        .action-icon-btn.like-btn svg {
            fill: none;
            stroke: var(--text-color);
            transition: fill 0.2s ease-in-out, stroke 0.2s ease-in-out;
        }

        .action-icon-btn.like-btn.liked svg {
            fill: var(--instagram-pink);
            stroke: var(--instagram-pink);
        }

        .heart-container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 34px;
            height: 34px;
            border-radius: 50%;
            border: 1px solid var(--input-bg);
            padding: 5px;
        }

        @media (min-width: 600px) {
            .story-cube-container {
                width: 375px;
                height: 667px;
                border-radius: 10px;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            }
            .bottom-bar {
                bottom: 0;
            }
            .status-content img {
                max-height: calc(100% - 90px);
                bottom: 20px;
            }
            .navigation {
                height: calc(100% - 70px);
            }
            .status-card[data-user="emily"] {
                transform: rotateY(0deg) translateZ(187.5px);
            }
            .status-card[data-user="michael"] {
                transform: rotateY(90deg) translateZ(187.5px);
            }
            .status-card[data-user="sarah"] {
                transform: rotateY(180deg) translateZ(187.5px);
            }
        }
    </style>
</head>
<body>
    <div class="story-cube-container">
        <div class="status-container" id="statusContainer">
            <div class="status-card" data-user="emily" data-status-index="0">
                <div class="progress-bar-container"></div>
                <div class="user-info">
                    <img class="profile-pic" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face" alt="Emily">
                    <div class="user-details">
                        <span class="username">Emily</span>
                        <span class="timestamp">Today at 12:30</span>
                    </div>
                </div>
                <div class="status-content">
                    <img src="https://picsum.photos/id/1000/500/800" alt="Story Image">
                </div>
                <div class="bottom-bar">
                    <div class="reply-input-container">
                        <input type="text" class="reply-input" placeholder="Reply to Emily...">
                    </div>
                    <button class="action-icon-btn like-btn" onclick="toggleLike(this)">
                        <div class="heart-container">
                            <svg class="svg-icon heart" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.03L12 21.35Z"></path>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>

            <div class="status-card" data-user="michael" data-status-index="0">
                <div class="progress-bar-container"></div>
                <div class="user-info">
                    <img class="profile-pic" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face" alt="Michael">
                    <div class="user-details">
                        <span class="username">Michael</span>
                        <span class="timestamp">Just now</span>
                    </div>
                </div>
                <div class="status-content">
                    <img src="https://picsum.photos/id/1000/500/800" alt="Story Image">
                </div>
                <div class="bottom-bar">
                    <div class="reply-input-container">
                        <input type="text" class="reply-input" placeholder="Reply to Michael...">
                    </div>
                    <button class="action-icon-btn like-btn" onclick="toggleLike(this)">
                        <div class="heart-container">
                            <svg class="svg-icon heart" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.03L12 21.35Z"></path>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>
            <div class="status-card" data-user="michael" data-status-index="1">
                <div class="progress-bar-container"></div>
                <div class="user-info">
                    <img class="profile-pic" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face" alt="Michael">
                    <div class="user-details">
                        <span class="username">Michael</span>
                        <span class="timestamp">Just now</span>
                    </div>
                </div>
                <div class="status-content">
                    <img src="https://picsum.photos/id/1001/500/800" alt="Story Image">
                </div>
                <div class="bottom-bar">
                    <div class="reply-input-container">
                        <input type="text" class="reply-input" placeholder="Reply to Michael...">
                    </div>
                    <button class="action-icon-btn like-btn" onclick="toggleLike(this)">
                        <div class="heart-container">
                            <svg class="svg-icon heart" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.03L12 21.35Z"></path>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>
            <div class="status-card" data-user="michael" data-status-index="2">
                <div class="progress-bar-container"></div>
                <div class="user-info">
                    <img class="profile-pic" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face" alt="Michael">
                    <div class="user-details">
                        <span class="username">Michael</span>
                        <span class="timestamp">Just now</span>
                    </div>
                </div>
                <div class="status-content">
                    <img src="https://picsum.photos/id/1002/500/800" alt="Story Image">
                </div>
                <div class="bottom-bar">
                    <div class="reply-input-container">
                        <input type="text" class="reply-input" placeholder="Reply to Michael...">
                    </div>
                    <button class="action-icon-btn like-btn" onclick="toggleLike(this)">
                        <div class="heart-container">
                            <svg class="svg-icon heart" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.03L12 21.35Z"></path>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>

            <div class="status-card" data-user="sarah" data-status-index="0">
                <div class="progress-bar-container"></div>
                <div class="user-info">
                    <img class="profile-pic" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face" alt="Sarah">
                    <div class="user-details">
                        <span class="username">Sarah</span>
                        <span class="timestamp">Just now</span>
                    </div>
                </div>
                <div class="status-content">
                    <img src="https://picsum.photos/id/1000/500/800" alt="Story Image">
                </div>
                <div class="bottom-bar">
                    <div class="reply-input-container">
                        <input type="text" class="reply-input" placeholder="Reply to Sarah...">
                    </div>
                    <button class="action-icon-btn like-btn" onclick="toggleLike(this)">
                        <div class="heart-container">
                            <svg class="svg-icon heart" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.03L12 21.35Z"></path>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>
            <div class="status-card" data-user="sarah" data-status-index="1">
                <div class="progress-bar-container"></div>
                <div class="user-info">
                    <img class="profile-pic" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face" alt="Sarah">
                    <div class="user-details">
                        <span class="username">Sarah</span>
                        <span class="timestamp">Just now</span>
                    </div>
                </div>
                <div class="status-content">
                    <img src="https://picsum.photos/id/1001/500/800" alt="Story Image">
                </div>
                <div class="bottom-bar">
                    <div class="reply-input-container">
                        <input type="text" class="reply-input" placeholder="Reply to Sarah...">
                    </div>
                    <button class="action-icon-btn like-btn" onclick="toggleLike(this)">
                        <div class="heart-container">
                            <svg class="svg-icon heart" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.03L12 21.35Z"></path>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>
            <div class="status-card" data-user="sarah" data-status-index="2">
                <div class="progress-bar-container"></div>
                <div class="user-info">
                    <img class="profile-pic" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face" alt="Sarah">
                    <div class="user-details">
                        <span class="username">Sarah</span>
                        <span class="timestamp">Just now</span>
                    </div>
                </div>
                <div class="status-content">
                    <img src="https://picsum.photos/id/1002/500/800" alt="Story Image">
                </div>
                <div class="bottom-bar">
                    <div class="reply-input-container">
                        <input type="text" class="reply-input" placeholder="Reply to Sarah...">
                    </div>
                    <button class="action-icon-btn like-btn" onclick="toggleLike(this)">
                        <div class="heart-container">
                            <svg class="svg-icon heart" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.03L12 21.35Z"></path>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>
            <div class="status-card" data-user="sarah" data-status-index="3">
                <div class="progress-bar-container"></div>
                <div class="user-info">
                    <img class="profile-pic" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face" alt="Sarah">
                    <div class="user-details">
                        <span class="username">Sarah</span>
                        <span class="timestamp">Just now</span>
                    </div>
                </div>
                <div class="status-content">
                    <img src="https://picsum.photos/id/1003/500/800" alt="Story Image">
                </div>
                <div class="bottom-bar">
                    <div class="reply-input-container">
                        <input type="text" class="reply-input" placeholder="Reply to Sarah...">
                    </div>
                    <button class="action-icon-btn like-btn" onclick="toggleLike(this)">
                        <div class="heart-container">
                            <svg class="svg-icon heart" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.03L12 21.35Z"></path>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <div class="navigation">
            <div class="nav-zone left" onclick="prevStatus()"></div>
            <div class="nav-zone right" onclick="nextStatus()"></div>
        </div>
    </div>

    <script>
        const statusContainer = document.getElementById("statusContainer");
        const statusCards = document.querySelectorAll('.status-card');
        const users = [...new Set(Array.from(statusCards).map(card => card.dataset.user))];
        const userStories = users.map(user => ({
            user,
            statusCount: document.querySelectorAll(`[data-user="${user}"]`).length
        }));
        
        let currentStoryIndex = 0;
        let currentStatusIndex = 0;
        let timer;
        const statusDuration = 5000;

        // Drag functionality variables
        let startX = 0;
        let currentRotation = 0;
        let isDragging = false;
        const dragThreshold = 100;
        const flipAngle = 90;

        // Set initial cube rotation based on the first story
        function updateCubeRotation() {
            const users = userStories.map(story => story.user);
            const userIndex = users.indexOf(userStories[currentStoryIndex].user);
            
            // Adjust rotation to face the correct user's story group
            const newRotation = userIndex * -flipAngle;
            statusContainer.style.transition = "transform 0.4s ease-in-out";
            statusContainer.style.transform = `rotateY(${newRotation}deg)`;
            currentRotation = newRotation;
        }

        function createProgressBars(statusCount, statusIndex) {
            const container = document.createElement('div');
            container.className = 'progress-bar-container';
            for (let i = 0; i < statusCount; i++) {
                const bar = document.createElement('div');
                bar.className = 'progress-bar';
                const progress = document.createElement('div');
                progress.className = 'progress';
                bar.appendChild(progress);
                container.appendChild(bar);
            }
            return container;
        }

        function showStatus(storyIndex, statusIndex) {
            clearTimeout(timer);

            // Hide all cards first
            statusCards.forEach(card => card.classList.remove('active'));

            const currentUsername = userStories[storyIndex].user;
            const currentCards = document.querySelectorAll(`.status-card[data-user="${currentUsername}"]`);
            const currentCard = currentCards[statusIndex];

            if (currentCard) {
                currentCard.classList.add('active');

                // Update the single active card's progress bars
                let progressBarContainer = currentCard.querySelector('.progress-bar-container');
                if (!progressBarContainer) {
                    progressBarContainer = document.createElement('div');
                    progressBarContainer.className = 'progress-bar-container';
                    currentCard.prepend(progressBarContainer);
                }
                
                progressBarContainer.innerHTML = '';
                for (let i = 0; i < currentCards.length; i++) {
                    const bar = document.createElement('div');
                    bar.className = 'progress-bar';
                    const progress = document.createElement('div');
                    progress.className = 'progress';
                    bar.appendChild(progress);
                    progressBarContainer.appendChild(bar);

                    if (i < statusIndex) {
                        progress.style.width = '100%';
                    }
                }
                
                const currentProgress = progressBarContainer.querySelectorAll('.progress-bar .progress')[statusIndex];
                if (currentProgress) {
                    setTimeout(() => {
                        currentProgress.style.transition = `width ${statusDuration / 1000}s linear`;
                        currentProgress.style.width = '100%';
                    }, 100);
                }

                timer = setTimeout(() => {
                    nextStatus();
                }, statusDuration);
            }
            
            updateCubeRotation();
        }

        function nextStatus() {
            const currentStory = userStories[currentStoryIndex];
            
            if (currentStatusIndex < currentStory.statusCount - 1) {
                currentStatusIndex++;
                showStatus(currentStoryIndex, currentStatusIndex);
            } else {
                currentStoryIndex++;
                if (currentStoryIndex < userStories.length) {
                    currentStatusIndex = 0;
                    showStatus(currentStoryIndex, currentStatusIndex);
                } else {
                    // Loop back to the start
                    currentStoryIndex = 0;
                    currentStatusIndex = 0;
                    showStatus(currentStoryIndex, currentStatusIndex);
                }
            }
        }

        function prevStatus() {
            const currentStory = userStories[currentStoryIndex];

            if (currentStatusIndex > 0) {
                currentStatusIndex--;
                showStatus(currentStoryIndex, currentStatusIndex);
            } else {
                currentStoryIndex--;
                if (currentStoryIndex >= 0) {
                    const prevStory = userStories[currentStoryIndex];
                    currentStatusIndex = prevStory.statusCount - 1;
                    showStatus(currentStoryIndex, currentStatusIndex);
                } else {
                    // Loop to the end
                    currentStoryIndex = userStories.length - 1;
                    const prevStory = userStories[currentStoryIndex];
                    currentStatusIndex = prevStory.statusCount - 1;
                    showStatus(currentStoryIndex, currentStatusIndex);
                }
            }
        }
        
        // --- Drag Functionality ---
        function startDrag(e) {
            clearTimeout(timer);
            isDragging = true;
            startX = e.pageX || e.touches[0].pageX;
            statusContainer.style.transition = "none";
        }

        function onDrag(e) {
            if (!isDragging) return;
            let currentX = e.pageX || e.touches[0].pageX;
            let deltaX = currentX - startX;
            statusContainer.style.transform = `rotateY(${currentRotation + deltaX / 2}deg)`;
        }

        function endDrag(e) {
            if (!isDragging) return;
            isDragging = false;
            let endX = e.pageX || e.changedTouches[0].pageX;
            let deltaX = endX - startX;

            if (deltaX < -dragThreshold && currentStoryIndex < userStories.length - 1) {
                currentStoryIndex++;
            } else if (deltaX > dragThreshold && currentStoryIndex > 0) {
                currentStoryIndex--;
            }

            // Reset status index for the new user's story
            currentStatusIndex = 0;
            showStatus(currentStoryIndex, currentStatusIndex);
        }
        
        // Add event listeners for dragging
        statusContainer.addEventListener("mousedown", startDrag);
        statusContainer.addEventListener("mousemove", onDrag);
        statusContainer.addEventListener("mouseup", endDrag);
        statusContainer.addEventListener("touchstart", startDrag);
        statusContainer.addEventListener("touchmove", onDrag);
        statusContainer.addEventListener("touchend", endDrag);

        function toggleLike(button) {
            button.classList.toggle('liked');
        }

        // Initialize with the first status
        showStatus(currentStoryIndex, currentStatusIndex);
    </script>
</body>
</html>
